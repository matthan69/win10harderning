#passwords
reg ADD HKLM\SYSTEM\CurrentControlSet\services\Netlogon\Parameters /v MaximumPasswordAge /t REG_DWORD /d 15 /f
net accounts /minpwlen:15
net accounts /minpwage:2
net accounts /uniquepw:24
secedit /export /cfg c:\secpol.cfg
	(gc C:\secpol.cfg).replace("PasswordComplexity = 1", "PasswordComplexity = 0") | Out-File C:\secpol.cfg
#lockout policies
net accounts /lockoutthreshold:10
net accounts /lockoutwindow:30
net accounts /lockoutduration:15
#checking user passwords pwease work uwu
On Error Resume Next

Set objNetwork = CreateObject(“Wscript.Network”)
strComputer = objNetwork.ComputerName


strPassword = “”


Set colAccounts = GetObject(“WinNT://” & strComputer)
colAccounts.Filter = Array(“user”)


For Each objUser In colAccounts
    objUser.ChangePassword strPassword, strPassword
   
    Err.Clear
Next
#disable remote desktop
Set-ItemProperty -Path ‘HKLM:\System\CurrentControlSet\Control\Terminal Server’-name “fDenyTSConnections” -Value 0
#windows smart screen 
reg ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer /v SmartScreenEnabled /t REG_SZ /d warn /f
#firewall
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
#limit user of blank passwords console only 
reg ADD HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v LimitBlankPasswordUse /t REG_DWORD /d 1 /f
#disable autoplay
$path ='HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer'
Set-ItemProperty $path -Name NoDriveTypeAutorun -Type DWord -Value 0xFF
#disable autorun
reg ADD HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer /v NoAutoRun /t REG_DWORD /d 1
#disable guest
Disable-LocalUser -Name "Guest"




#updates windows will reboot
Install-Module PSWindowsUpdate
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update" /v AUOptions /t REG_DWORD /d 3 /f
Get-WindowsUpdate -AcceptAll -Install -AutoReboot
